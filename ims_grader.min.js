javascript:(function(){if(window.app){return;}window.app={},app.sep=function(){console.log("")},app.indi=function(a){return a=$(a),obj={},tds=a.find("td"),obj.sem=tds.eq(0).text().trim(),obj.code=tds.eq(1).text().trim(),obj.course=tds.eq(2).text().trim(),obj.credits=parseInt(tds.eq(3).text().trim(),10),obj.grade=tds.eq(4).find("input").val(),obj},app.process=function(){var a={},b="",c=parseFloat(prompt("Unrecorded CPI (Optional)"))||0,d=parseInt(prompt("Unrecorded Total credits (Optional)"))||0,e=parseInt(prompt("Unrecorded Credit Points You Earned (Optional)"))||0,f=c,g=e,h=d;if(f||g||h){if(!f&&!g||!g&&!h||!f&&!h)return void alert("Insufficient data. Couldn't calculate CPI.");e=e||Math.round(c*d),c=c||e/d,d=d||Math.round(e/c)}b="\nUnrecorded Credit Points you earned: "+e+"\nUnrecorded Total Credits: "+d+"\nUnrecorded CPI: "+c.toFixed(2),map={"A+":11,A:10,"A-":9,B:8,"B-":7,C:6,"C-":5,D:4,F:0},$(".st_grid_row").each(function(){obj=app.indi(this),obj.sem in a||(app.sep(),a[obj.sem]={total_credits:0,total_points:0}),map[obj.grade]?(console.log(obj.sem+": Considering",obj.code,"("+obj.course+")"),a[obj.sem].total_credits+=obj.credits,a[obj.sem].total_points+=obj.credits*map[obj.grade]):console.log(obj.sem+": Not considering",obj.code,"("+obj.course+")")}),app.sep();for(var i in a)tp=a[i].total_points,tc=a[i].total_credits,d+=tc,e+=tp,spi=(tp/tc).toFixed(2),b="SPI for "+i+" : "+spi+" \n"+b,console.log("SPI for ",i,":",spi);app.sep(),final_cpi=(e/d).toFixed(2),b="<b>CPI: "+final_cpi+"</b>\n\n"+b,console.log("Final CPI: "+final_cpi),$("div.span11 input").val(final_cpi),$("div.span12:last,div.span12:last input").css({"line-height":"18pt","font-size":"18pt",height:"32px","font-weight":"bold"}),$("div.span12:last").css({"margin-top":"-10px"}),$(".widget-title").after('<hr/><p style="padding-left:10px;">'+b.replace(/\n/g,"<br/>")+"</p>")},app.reset=function(){$(".st_grid_row td:nth-child(5) input").val(function(){return $(this).data().default})},app.init=function(){$(".widget-title").after('<hr/><p style="text-align:center;margin-bottom:0;"><button onclick="app.process();" type="button" style="font-size:16pt;">Calculate CPI</button><button onclick="app.reset();" type="button" style="font-size:16pt;">Reset grades</button></p><hr/>'),$(".st_grid_row td:nth-child(5)").replaceWith(function(){var a=$(this).text().trim();return'<td><input data-default="'+a+'" value="'+a+'"></input></td>'})},app.init();})();
